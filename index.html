<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>抽盲盒機器</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; background: #f0f8ff; padding: 50px; }
    h1 { color: #ff69b4; }
    #box { width: 300px; height: 300px; margin: 20px auto; background: #fff; border: 5px dashed #ff69b4; border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
    button { padding: 15px 30px; font-size: 20px; background: #ff69b4; color: white; border: none; border-radius: 10px; cursor: pointer; }
    button:hover { background: #ff1493; }
    #result { margin-top: 30px; font-size: 28px; color: #ff69b4; }
    img { max-width: 250px; max-height: 250px; border-radius: 10px; }
  </style>
</head>
<body>
  <h1>盲盒抽獎機器</h1>
  <div id="box">點擊下面按鈕抽盲盒！</div>
  <button onclick="drawBox()">抽一個盲盒！</button>
  <div id="result"></div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
    import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDh4IB8fakLIj_PAOM76uSRQtneMeRDY7o",
      authDomain: "project1225-e9577.firebaseapp.com",
      projectId: "project1225-e9577",
      storageBucket: "project1225-e9577.firebasestorage.app",
      messagingSenderId: "846279084104",
      appId: "1:846279084104:web:47f58714c0354fca59307d",
      databaseURL: "https://project1225-e9577-default-rtdb.firebaseio.com/"  // 記得加你的 database URL
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    async function drawBox() {
      const resultDiv = document.getElementById('result');
      const boxDiv = document.getElementById('box');
      resultDiv.innerHTML = '抽獎中...';
      boxDiv.innerHTML = '轉轉轉...';

      try {
        const snapshot = await get(ref(db, 'items'));
        if (snapshot.exists()) {
          const items = snapshot.val();
          const keys = Object.keys(items);
          const randomKey = keys[Math.floor(Math.random() * keys.length)];
          const item = items[randomKey];

          resultDiv.innerHTML = `
            <h2>恭喜抽到！</h2>
            <p><strong>${item.name}</strong> (${item.rarity})</p>
            <img src="${item.image}" alt="${item.name}">
          `;
          boxDiv.innerHTML = '抽完了！再抽一個？';
        } else {
          resultDiv.innerHTML = '資料庫沒有物品喔！';
        }
      } catch (error) {
        resultDiv.innerHTML = '錯誤：' + error.message;
      }
    }
  </script>
</body>
</html>